<!---
# cspell: ignore Bambu, pyinstaller, BambuLab, Jayo
---> 

# slicer_tools

A library of python tools for working with 3D slicer files (.3mf). Currently the
library supports Bambu Studio on the following very limited function set:
- Comparison of printer presets across multiple files. Comparisons are presented
as Excel (.xlsx, readable by LibreOffice) files, which detail the differences between
presets in all of the selected files and the system presets. The main purpose of this
is to extract common settings from multiple files, but may also be useful in debugging
files with many changes.
- A dumper that will export all settings contained in preset (generated by walking
the preset inheritance tree).

Minor editorial comment: The preset file structure used by BambuStudio (and presumably other slicers in the same family) is so chaotic and internally inconsistent that while this project should have been a couple of hundred lines of quick and dirty code, it's now approaching 2000 for fairly minimal functionality. I'm releasing it because the difference function has been genuinely useful for me in building new presets, and the dump function is useful for checking presets. It also provides a first pass for programmatic access to .3mf files and presets, but it's up to someone else to decide if it is worth picking up to do more with.

# Change Log

From v0.9.0 is the first release, with limited feature set.

# WARNINGS: PLEASE READ THIS SECTION

# Installation

Two options: 

- Download the Windows executable (created with pyinstaller) from the [Releases](https://github.com/BuongiornoTexas/slicer_tools/releases) page.

- Install the package from pip: `pip install slicer_tools`.

To run, fire up a command or terminal window and run `slicer_tools.exe`, or to run from the python package, use `py -m slicer_tools.tools`. The rest of the docs use `slicer_tools.exe`, but feel free to use the python version if you want very slightly faster output (or if you are on a non-windows platform).  

# Usage

## Differences

To generate preset differences for a single file, run:

`slicer_tools diff --source <path to 3mf file> --output <output file>`

The output file is optional and defaults to `preset_diffs.xlsx`, and will be created in the same folder as the input file.

To generate preset differences for all `.3mf` files in a folder, run:

`slicer_tools diff --source <path to folder> --output <output file>`

Both source and output are optional for this mode. If source is skipped, the difference will be performed on the working directory, and if output is skipped, the output is written to `preset_diffs.xlsx`.

For help, run `slicer_tools diff -h`.

See [Difference File Structure](#difference-file-structure) for details and cautions on using the output file.

## Preset Export

To generate one or more complete presets from a single file, each in `.json` format, run:

`slicer_tools export <path to file name>`

The slicer tools will then guide you through selecting the preset type you want to export and allow you to choose one or more presets of that type for export.

As I've needed to do some hacks for generating differences, please read the **WARNINGS** in the following section, as the exported files may not perfectly match the structure used internally by BambuStudio (they work well enough for the purposes of creating new presets, and I've run out of patience to deal with the special cases). The warnings about the following special fields are relevant:

- `name` and `<type>_settings_id`.
- `inherits`.
- `from`.
- `version`. 

If you plan to use any of these fields, please cross check against the original preset file. 

All other fields should be consistent with the original files and inheritance trees.

# Difference File Structure


# Workflow for Creating New Presets

I'd suggest using this process for creating **process** and **filament** presets only. A lot could go wrong with tweaking **machine** presets, so this is probably better done within the slicer itself.

- Run BambuStudio.
- Create a dummy preset to use as a template:
  1) Start with a preset that is the basis for the new preset. For example,
  for a generic TPU, select "Generic TPU" or "Bambulab TPU95A", or for a process preset for the X1C start with "0.20mm Standard @BBL X1C".
  2) Save the preset as a **user** preset. E.g. "Jayo TPU" or "0.20mm Standard for Jayo TPU @BBL X1C". **Don't** make any changes to this preset.
  3) Export the presets. `File->Export->Export Preset Bundle ... `
     - `-> Process presets(.zip)` and extract the preset .json file you have just created.
     - `-> Filament presets(.zip)` and extract the preset .json file you have just created.

     These json files are the templates for your new presets, and should have all of the *special* fields prepopulated for you - See [Warnings](#warnings-please-read-this-section).
  
  4) Back inside Bambu Studio, **DELETE** the presets you created in step (2).

- Paste fields you have created into the template(s) created in step (3), taking care to not replace any of the existing *special* template fields.

- Import the template(s) back into Bambu Studio. `File->Import->Import Configs`.

Finally use the slicer_tools utility (difference or dump) or the slicer GUI compare interface to check that your new preset settings match up with the settings you created above.

